<!DOCTYPE html>
<html lang="zxx">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="css/task.css">
	<link rel="icon" href="img/favicon.ico" type="image/x-icon">
	<title>Урок №1. Вступ до типізації. Розширені типи</title>
</head>

<body>
	<div class="wrapper">
		<header class="header" id="header">
			<div class="header__container">
				<div class="header__logo">
					<img src="img/ts-logo.jpg" alt="логотип компанії TypeScript" class="header__img">
				</div>
			</div>
		</header>
		<main class="page">
			<section class="page__task task">
				<div class="task__container">
					<h1 class="task__title">
						Урок №1. Вступ до типізації. Розширені типи
					</h1>

					<div class="task__text">
						<ul class="task__list list">
							<li class="list__item">
								<p><strong>Задача 1.</strong> У localStorage зберігається об’єкт у форматі JSON з ключем «data».
									Проаналізувати значення поля «field2». Якщо
									рядок – то вивести довжину, якщо число – то визначити чи є парним.
								</p>
								<details>
									<summary>Переглянути код</summary>
									<pre><code>type PrimitiveType = string | number
									
									function validateFieldType(value: unknown, fieldName: string): PrimitiveType {
									if(typeof value === "string" || typeof value === 'number'){
									return value
									}else{
									throw new Error(`Неправильний тип для поля ${fieldName}: отримано ${typeof value}`);
									}
									}
									
									const raw = localStorage.getItem('data')
									if(raw) {
									try {
									const obj= JSON.parse(raw)
									const field2=validateFieldType(obj.field2, 'field2')
									
									let result = ''
									if(typeof field2 === 'string') {
									result=`Поле ${field2} є рядком довжиною ${field2.length}`
									}else{
									const evenOrOddNum: 'парне' | 'непарне' = field2 % 2 === 0 ? 'парне' : 'непарне'
									result=`Поле ${field2} є числом, воно ${evenOrOddNum}`
									}
									console.log(result);
									} catch (error) {
									if(error instanceof Error){
									console.log(error.message);
									}else{console.log(String(error))}
									}
									}
									//---
									const test1 = localStorage.setItem('data',JSON.stringify({field2:77}))
									// const test2 = localStorage.setItem('data',JSON.stringify({field2:"тест"}))</code>
										</pre>
								</details>
							</li>
							<li class="list__item">
								<p><strong>Задача 2.</strong> У localStorage зберігається об’єкт у форматі JSON з ключем «data».
									Вивести на екран усі поля та їх значення.
								</p>
								<details>
									<summary>Переглянути код</summary>
									<pre><code>const userInfo={
									name:'Ivan',
									age: 30,
									isAdmin:true,
									skills:['JS','TS']
									}
									//---
									localStorage.setItem('userInfoData',JSON.stringify(userInfo))
									
									function displayLocalStorageObject(key:string, displayElementId:string='display'):void {
									const rawData=localStorage.getItem(key)
									if(!rawData){
									console.log(`Дані з ключем "${key}" не знайдено в localStorage`);
									return
									}
									try {
									const obj =JSON.parse(rawData)
									
									if(typeof obj!=='object'||obj===null){
									throw new Error(`Значення за ключем ${key} не є об'єктом`);
									}
									let result2 =`Дані з ключем "${key}":\n`
									
									for (const key of Object.keys(obj)) {
									result2+=`${key}:${obj[key]}\n`
									}
									
									console.log(result2);
									
									const displayEl = document.getElementById(displayElementId)
									if(displayEl){
									displayEl.innerText=result2
									}
									} catch (error) {
									if(error instanceof Error){
									console.log(error.message);
									}else{console.log(String(error))}
									}
									}
									//---
									displayLocalStorageObject('userInfoData')</code></pre>
								</details>
								<div id="display"></div>
							</li>
							<li class="list__item">
								<p><strong>Задача 3.</strong> Вводиться назва продукту, ціна одиниці та кількість для 2-х видів
									товарів. Вивести чек про купівлю.
								</p>
								<details>
									<summary>Переглянути код</summary>
									<pre><code>type Product = {
									name: string,
									price: number,
									quantity: number,
									}
									//---
									const calculateProductTotal= (product: Product): number =>
									product.price*product.quantity
									//---
									const calculateTotal=(products:Product[]):number=>
									products.reduce((sum, product)=>sum+calculateProductTotal(product),0)
									//---
									const generateReceipt=(products:Product[]):string=>{
									const lines=products.map(product=>{
									const total = calculateProductTotal(product)
									return `${product.name} - ${product.quantity} x ${product.price.toFixed(2)} = ${total.toFixed(2)} грн`
									})
									
									const receipt=[
									"Фіскальний чек",
									"*********",
									...lines,
									"*********",
									`Загальна сума: ${calculateTotal(products).toFixed(2)} грн`,
									].join("\n")
									
									return receipt
									}
									//---
									const products: Product[]=[
									{ name: "Молоко", price: 32.5, quantity: 2 },
									{ name: "Хліб", price: 18.0, quantity: 3 },
									]
									console.log(generateReceipt(products));
									//---
									const receiptEl = document.getElementById('receipt')
									if(receiptEl) {
									receiptEl.innerText=generateReceipt(products)
									}</code></pre>
								</details>
								<div id="receipt"></div>
							</li>
							<li class="list__item">
								<p><strong>Задача 4.</strong> Вводиться номер дня або назва дня. Створити функцію, яка за цим
									значенням виводить на екран чи це робочий день.
								</p>
								<details>
									<summary>Переглянути код</summary>
									<pre><code>type DayNameString ='sun'| 'mon' | 'tue' | 'wed' | 'thu' | 'fri' | 'sat'
									type DayNameNumber = 0| 1 | 2 | 3 | 4 | 5 | 6
									type DayName = DayNameString | DayNameNumber
									
									const dayNames: DayNameString[] = ['sun', 'mon' , 'tue' , 'wed' , 'thu' , 'fri' , 'sat']
									const workingDaysStr: DayNameString[] = ['mon' , 'tue' , 'wed' , 'thu' , 'fri']
									const workingDaysNum: DayNameNumber[] =[1 , 2 , 3 , 4 , 5]
									//---
									const isWorkingDay=(day: DayName):boolean => typeof day === 'string' ? workingDaysStr.includes(day):
									workingDaysNum.includes(day)
									//---
									const isDayNameNumber=(value: number):value is DayNameNumber=>value>= 0 && value<dayNames.length 
									//--- const checkDay=():void=>{
										const showDay=document.getElementById('dayResult')
										const userInputDay=prompt(`Введіть назву (mon-sun) дня або номер дня (1-7)`)?.trim()?.toLowerCase();
									
										if(!showDay || !userInputDay) return
									
										const parsed = parseInt(userInputDay)
									
										let day: DayName | undefined
										const matched = dayNames.find(name=>name===userInputDay)
										if(matched){
										day=matched
										}else if (!isNaN(parsed) && isDayNameNumber(parsed-1)) {
										day=parsed-1
										}
									
										if(day!==undefined){
										const result3 = isWorkingDay(day) ? 'Це робочий день' : 'Це вихідний'
										showDay.innerText=`${userInputDay} - ${result3} `
										}else{
										showDay.innerText=`${userInputDay} - Некоректне значення дня`
										showDay.style.color='red'
										}
										}
										//---
										window.onload=()=>{
										checkDay()
										}</code></pre>
								</details>
								<div id="dayResult"></div>
							</li>
							<li class="list__item">
								<p><strong>Задача 5.</strong> Випадковим чином 10 разів генерується число або рядок «Ок».
									Пірахувати чого було більше чисел чи рядків і вивести
									останнє значення
								</p>
								<details>
									<summary>Переглянути код</summary>
									<pre><code>function generateAndCompare(iterations:number=10): {
									moreOfWhat:string
									lastValue: number | 'Ok'
									}{
									let numberCount=0
									let stringOkCount=0
									type NumOrOk= number | 'Ok'
									let val: NumOrOk='Ok'
									
									for (let i = 0; i < iterations; i++) { val=Math.random()>0.5 ? 5 : 'Ok'
									
										if (val === 'Ok') {
										stringOkCount++
										}else {
										numberCount++
										}
										console.log(`Згенеровано: ${val}`);
										}
										const moreOfWhat = numberCount>stringOkCount? 'чисел':'рядків "Ok"'
										return {
										moreOfWhat,lastValue:val,
										}
										}
										//---
										const result4=generateAndCompare()
									
										console.log(`Було більше ${result4.moreOfWhat}`);
									
										console.log(`Останнє значення: ${result4.lastValue}`);
										//---
										const lastVal = document.getElementById('lastVal')
										if(lastVal) {
										lastVal.innerText=`Було більше ${result4.moreOfWhat}.\n Останнє значення: ${result4.lastValue} `
										}</code></pre>
								</details>
								<div id="lastVal"></div>
							</li>
							<li class="list__item">
								<p><strong>Задача 6.</strong> Вводиться сума грошей і позначення валюти. Потрібно перевести у
									інші валюти ("USD" , "EUR" , "UAH"). Тобто якщо вводять
									гривні, то перевести у долари і євро. А якщо вводять долари, то перевести у гривні і євро.
									Курси валют – це константи.
								</p>
								<details>
									<summary>Переглянути код</summary>
									<pre><code>type Currency = "USD" | "EUR" | "UAH"
									
									type Rates = {
									USD: number;
									EUR: number;
									UAH: number;
									}
									
									function convertCurrency(currency:Currency,sum:number,rates:Rates):string {
									const fromRate=rates[currency]
									let result = `Ви ввели: ${sum} ${currency}\n`
									
									const allCurrencies: Currency[]=["USD","EUR","UAH"]
									for (let i = 0; i < allCurrencies.length; i++) { const targetCurrency=allCurrencies[i]
										if(targetCurrency===currency)continue const toRate=rates[targetCurrency] const converted=(sum*fromRate)/toRate
										result+=`У ${targetCurrency}: ${converted.toFixed(2)} ${targetCurrency}\n` } return result } //--- function
										handleUserInput(rates:Rates): void { const userInput=prompt("Оберіть валюту: USD | EUR | UAH")?.toUpperCase().trim()
										?? "" const sum=parseFloat(prompt("Введіть суму грошей") ?? "0" ) const result5=document.getElementById("convertRes")
										if(!result5) return if(userInput==="USD" || userInput==="EUR" || userInput==="UAH" ){ const currency:
										Currency=userInput const resultText=convertCurrency(currency,sum,rates) result5.innerText=resultText }else{
										result5.innerText="Некоректна валюта" } } //--- const rates: Rates={ USD: 42, EUR: 46, UAH: 1, } //---
										handleUserInput(rates)</code></pre>
								</details>
								<div id="convertRes"></div>
							</li>
						</ul>
						<script src="./javascript/lesson1.js"></script>
					</div>
				</div>
			</section>
		</main>
		<footer class="footer">
			<a class="footer__link" href="https://www.typescriptlang.org/">TypeScript</a>
			<a class="footer__link" href="../../index.html">На головну сторінку</a>
		</footer>
	</div>

</body>

</html>